<div class="container">
  <h1>Publier un projet</h1>
  <form #projectForm="ngForm" (ngSubmit)="onSubmit(projectForm)">
    <mat-form-field appearance="fill" style="width: 100%;">
      <mat-label>Nom de votre projet:</mat-label>
      <input matInput placeholder="Entrez le nom du projet" name="name" [(ngModel)]="project.name" required>
      @if(projectForm.submitted && projectForm.controls['name']?.errors?.['required']){
        <mat-error >
         Un nom est nécessaire
        </mat-error>
      }
    </mat-form-field>

   <mat-form-field appearance="fill" style="width: 100%;">
      <mat-label>Description de votre projet:</mat-label>
      <textarea matInput placeholder="Entrez la description" name="description" [(ngModel)]="project.description" required></textarea>
      @if(projectForm.submitted && projectForm.controls['description']?.errors?.['required']){
        <mat-error >
          Description is required
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" style="width: 100%;">
    <mat-label>Relance</mat-label>
    <mat-select name="volet_relance" [(ngModel)]="project.volet_relance" required>
      <mat-option *ngFor="let opt of RelanceOption" [value]="opt">
        {{ opt }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="projectForm.submitted && projectForm.controls['volet_relance']?.errors?.['required']">
      Sélectionnez une option pour Relance
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill" style="width: 100%;">
    <mat-label>Mesure</mat-label>
    <mat-select name="mesure" [(ngModel)]="project.mesure" required>
      <mat-option *ngFor="let opt of MesureOption" [value]="opt">
        {{ opt }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="projectForm.submitted && projectForm.controls['mesure']?.errors?.['required']">
      Sélectionnez une option pour Mesure
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill" style="width: 100%;">
    <mat-label>Mesure Light</mat-label>
    <mat-select name="mesure_light" [(ngModel)]="project.mesure_light" required>
      <mat-option *ngFor="let opt of MesureLightOption" [value]="opt">
        {{ opt }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="projectForm.submitted && projectForm.controls['mesureLight']?.errors?.['required']">
      Sélectionnez une option pour Mesure Light
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill" style="width: 100%;">
    <mat-label>Filière</mat-label>
    <mat-select name="filiere" [(ngModel)]="project.filiere" required>
      <mat-option *ngFor="let opt of FiliereOption" [value]="opt">
        {{ opt }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="projectForm.submitted && projectForm.controls['filiere']?.errors?.['required']">
      Sélectionnez une option pour Filière
    </mat-error>
  </mat-form-field>

    <div class="map-container">
      <div id="map"></div>
    </div>
    <div class="location-fields">
      <mat-form-field appearance="fill">
        <mat-label>Ville</mat-label>
        <input matInput [value]="project.city" readonly>
        @if(projectForm.submitted && projectForm.controls['city']?.errors?.['required']){
          <mat-error >
            Veuillez choisir une localisation sur la carte
          </mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Département</mat-label>
        <input matInput [value]="project.department" readonly>
        @if(projectForm.submitted && projectForm.controls['department']?.errors?.['required']){
          <mat-error >
            Veuillez choisir une localisation sur la carte
          </mat-error>
        }
      </mat-form-field>
    </div>
    <div mat-dialog-actions style="justify-content: flex-end;">
      <button mat-button type="submit" [disabled]="!projectForm.valid">Créér Projet</button>
    </div>
  </form>
</div>
